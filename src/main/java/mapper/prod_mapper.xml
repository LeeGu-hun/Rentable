<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="prodSQL">

	<select id="prodView" parameterType="int" resultType="bean.bean_rent_products">
		SELECT *
		FROM RENT_PRODUCTS WHERE RP_ITEMNUM=#{RP_itemnum}
	</select>

	<insert id="orderInsert" parameterType="bean.bean_rent_orders">
		insert into RENT_ORDERS
		values((select nvl(max(RO_ORDERNUM),0)+1 from
		RENT_ORDERS),#{RO_usernum},#{RO_total},sysdate)
	</insert>

	<select id="orderNum" resultType="int">
		select max(RO_ORDERNUM) from RENT_ORDERS
	</select>

	<insert id="orderItemInsert" parameterType="bean.bean_rent_order_items">
		insert into RENT_ORDERS_ITEMS
		values((select nvl(max(ROI_ITEMID),0)+1 from
		RENT_ORDERS_ITEMS),#{ROI_ordernum},#{ROI_itemnum},#{ROI_price},
		#{ROI_startdate},#{ROI_enddate},#{ROI_buyidnum},#{ROI_saleidnum},#{ROI_stat},#{ROI_buyername},#{ROI_buyeraddress},
		#{ROI_buyerphone},#{ROI_comment})
	</insert>

	<select id="userSaleBuy" parameterType="int" resultType="bean.bean_rent_user_slae">
		select
		RENT_ORDERS_ITEMS.ROI_ORDERNUM,RENT_PRODUCTS.RP_ITEMNAME,ROI_ENDDATE,ROI_PRICE,RENT_ORDERS_ITEMS.ROI_STAT
		from RENT_ORDERS_ITEMS,RENT_PRODUCTS where
		RENT_ORDERS_ITEMS.ROI_ITEMNUM=RENT_PRODUCTS.RP_ITEMNUM and
		RENT_ORDERS_ITEMS.ROI_BUYIDNUM=#{ROI_buyidnum} order by
		RENT_ORDERS_ITEMS.ROI_ENDDATE
	</select>
	
	<select id="userSaleSell" parameterType="int" resultType="bean.bean_rent_user_slae">
		select
		RENT_ORDERS_ITEMS.ROI_ORDERNUM,RENT_PRODUCTS.RP_ITEMNAME,ROI_ENDDATE,ROI_PRICE,RENT_ORDERS_ITEMS.ROI_STAT
		from RENT_ORDERS_ITEMS,RENT_PRODUCTS where
		RENT_ORDERS_ITEMS.ROI_ITEMNUM=RENT_PRODUCTS.RP_ITEMNUM and
		RENT_ORDERS_ITEMS.ROI_SALEIDNUM=#{ROI_saleidnum} order by
		RENT_ORDERS_ITEMS.ROI_ENDDATE
	</select>
</mapper>

